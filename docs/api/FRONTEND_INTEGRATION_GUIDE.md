# Frontend Geli≈ütiriciler ƒ∞√ßin TE4IT API Entegrasyon Rehberi

**S√ºr√ºm:** 2.0  
**Tarih:** Ocak 2025  
**Hedef:** React, Vue, Angular ve diƒüer frontend framework'leri  
**Not:** Bu dok√ºmantasyon web platformu i√ßin hazƒ±rlanmƒ±≈ütƒ±r. Mobil uygulamalar i√ßin ayrƒ± dok√ºmantasyon mevcuttur.

---

## üìã ƒ∞√ßindekiler

1. [Hƒ±zlƒ± Ba≈ülangƒ±√ß](#hƒ±zlƒ±-ba≈ülangƒ±√ß)
2. [Auth Endpoint'leri Rehberi](#auth-endpointleri-rehberi)
3. [React Entegrasyonu](#react-entegrasyonu)
4. [Email Link Handling](#email-link-handling)
5. [Hata Y√∂netimi](#hata-y√∂netimi)
6. [G√ºvenlik En ƒ∞yi Uygulamalarƒ±](#g√ºvenlik-en-iyi-uygulamalarƒ±)
7. [Test Senaryolarƒ±](#test-senaryolarƒ±)

---

## üöÄ Hƒ±zlƒ± Ba≈ülangƒ±√ß

### 1. API Base URL'leri

```javascript
// Environment'a g√∂re base URL se√ßimi
const API_BASE_URL = process.env.NODE_ENV === 'production' 
  ? 'https://te4it-api.azurewebsites.net' 
  : 'https://localhost:5001';

const API_ENDPOINTS = {
  auth: `${API_BASE_URL}/api/v1/auth`,
  projects: `${API_BASE_URL}/api/v1/projects`,
  tasks: `${API_BASE_URL}/api/v1/tasks`
};
```

### 2. Temel Auth Service

```javascript
class TE4ITAuthService {
  constructor(baseUrl = API_BASE_URL) {
    this.baseUrl = baseUrl;
    this.accessToken = localStorage.getItem('accessToken');
    this.refreshToken = localStorage.getItem('refreshToken');
  }

  // Token'larƒ± localStorage'a kaydet
  saveTokens(accessToken, refreshToken) {
    this.accessToken = accessToken;
    this.refreshToken = refreshToken;
    localStorage.setItem('accessToken', accessToken);
    localStorage.setItem('refreshToken', refreshToken);
  }

  // Token'larƒ± temizle
  clearTokens() {
    this.accessToken = null;
    this.refreshToken = null;
    localStorage.removeItem('accessToken');
    localStorage.removeItem('refreshToken');
  }

  // HTTP istekleri i√ßin header hazƒ±rla
  getAuthHeaders() {
    return {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${this.accessToken}`
    };
  }

  // API √ßaƒürƒ±sƒ± yap
  async apiCall(endpoint, options = {}) {
    const url = `${this.baseUrl}${endpoint}`;
    const config = {
      ...options,
      headers: {
        ...this.getAuthHeaders(),
        ...options.headers
      }
    };

    const response = await fetch(url, config);
    
    // Token s√ºresi dolmu≈üsa yenile
    if (response.status === 401 && this.refreshToken) {
      await this.refreshAccessToken();
      // Tekrar dene
      config.headers.Authorization = `Bearer ${this.accessToken}`;
      return fetch(url, config);
    }

    return response;
  }
}
```

---

## üîê Auth Endpoint'leri Rehberi

### **1. Kullanƒ±cƒ± Kaydƒ± (Register)**

#### **Ne Yapmalƒ±sƒ±nƒ±z:**
- Kullanƒ±cƒ±dan `userName`, `email`, `password` bilgilerini isteyin
- Form validasyonu yapƒ±n (email formatƒ±, ≈üifre g√º√ßl√ºl√ºƒü√º)
- `POST /api/v1/auth/register` endpoint'ini √ßaƒüƒ±rƒ±n
- Ba≈üarƒ±lƒ± olursa kullanƒ±cƒ±yƒ± otomatik giri≈ü yapƒ±n
- Token'larƒ± localStorage'a kaydedin
- Dashboard sayfasƒ±na y√∂nlendirin

#### **Request Format:**
```json
{
  "userName": "johndoe",
  "email": "john@example.com", 
  "password": "SecurePass123!"
}
```

#### **Response Format:**
```json
{
  "userId": "123e4567-e89b-12d3-a456-426614174000",
  "userName": "johndoe",
  "email": "john@example.com",
  "accessToken": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expiresAt": "2025-01-13T15:30:00Z",
  "refreshToken": "refresh_token_here",
  "refreshExpires": "2025-01-20T15:30:00Z"
}
```

#### **Hata Durumlarƒ±:**
- **400 Bad Request**: Email zaten kayƒ±tlƒ±, ≈üifre √ßok zayƒ±f
- **422 Validation Error**: Form validasyon hatalarƒ±
- **500 Internal Server Error**: Sunucu hatasƒ±

---

### **2. Kullanƒ±cƒ± Giri≈üi (Login)**

#### **Ne Yapmalƒ±sƒ±nƒ±z:**
- Kullanƒ±cƒ±dan `email` ve `password` bilgilerini isteyin
- Form validasyonu yapƒ±n (email formatƒ±, ≈üifre bo≈ü deƒüil)
- `POST /api/v1/auth/login` endpoint'ini √ßaƒüƒ±rƒ±n
- Ba≈üarƒ±lƒ± olursa token'larƒ± localStorage'a kaydedin
- Dashboard sayfasƒ±na y√∂nlendirin

#### **Request Format:**
```json
{
  "email": "john@example.com",
  "password": "SecurePass123!"
}
```

#### **Response Format:**
```json
{
  "userId": "123e4567-e89b-12d3-a456-426614174000",
  "email": "john@example.com",
  "accessToken": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expiresAt": "2025-01-13T15:30:00Z",
  "refreshToken": "refresh_token_here",
  "refreshExpires": "2025-01-20T15:30:00Z"
}
```

#### **Hata Durumlarƒ±:**
- **401 Unauthorized**: Yanlƒ±≈ü email/≈üifre
- **400 Bad Request**: Ge√ßersiz form verisi
- **429 Too Many Requests**: √áok fazla deneme

---

### **3. Token Yenileme (Refresh Token)**

#### **Ne Yapmalƒ±sƒ±nƒ±z:**
- Access token s√ºresi dolduƒüunda otomatik olarak √ßaƒüƒ±rƒ±n
- `refreshToken`'ƒ± localStorage'dan alƒ±n
- `POST /api/v1/auth/refreshToken` endpoint'ini √ßaƒüƒ±rƒ±n
- Yeni token'larƒ± localStorage'a kaydedin
- Orijinal isteƒüi yeni token ile tekrar g√∂nderin

#### **Request Format:**
```json
{
  "refreshToken": "your_refresh_token_here"
}
```

#### **Response Format:**
```json
{
  "accessToken": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expiresAt": "2025-01-13T16:30:00Z",
  "refreshToken": "new_refresh_token_here",
  "refreshExpires": "2025-01-20T16:30:00Z"
}
```

#### **Hata Durumlarƒ±:**
- **401 Unauthorized**: Refresh token ge√ßersiz/s√ºresi dolmu≈ü
- **400 Bad Request**: Ge√ßersiz refresh token

---

### **4. √áƒ±kƒ±≈ü Yapma (Logout)**

#### **Ne Yapmalƒ±sƒ±nƒ±z:**
- `refreshToken`'ƒ± localStorage'dan alƒ±n
- `POST /api/v1/auth/revokeRefreshToken` endpoint'ini √ßaƒüƒ±rƒ±n
- Authorization header'ƒ±nda access token g√∂nderin
- Token'larƒ± localStorage'dan silin
- Login sayfasƒ±na y√∂nlendirin

#### **Request Format:**
```json
{
  "refreshToken": "refresh_token_to_revoke"
}
```

#### **Response Format:**
- **204 No Content**: Ba≈üarƒ±lƒ± √ßƒ±kƒ±≈ü

#### **Hata Durumlarƒ±:**
- **401 Unauthorized**: Ge√ßersiz access token
- **400 Bad Request**: Ge√ßersiz refresh token

---

### **5. ≈ûifre Sƒ±fƒ±rlama ƒ∞steƒüi (Forgot Password)**

#### **Ne Yapmalƒ±sƒ±nƒ±z:**
- Kullanƒ±cƒ±dan sadece `email` adresini isteyin
- Email formatƒ± validasyonu yapƒ±n
- `POST /api/v1/auth/forgotPassword` endpoint'ini √ßaƒüƒ±rƒ±n
- Her durumda "Email adresinize ≈üifre sƒ±fƒ±rlama linki g√∂nderildi" mesajƒ± g√∂sterin
- Login sayfasƒ±na "Giri≈ü Sayfasƒ±na D√∂n" linki ekleyin

#### **Request Format:**
```json
{
  "email": "john@example.com"
}
```

#### **Response Format:**
```json
{
  "success": true,
  "message": "≈ûifre sƒ±fƒ±rlama linki email adresinize g√∂nderildi"
}
```

#### **Hata Durumlarƒ±:**
- **400 Bad Request**: Ge√ßersiz email formatƒ±
- **429 Too Many Requests**: √áok fazla istek

---

### **6. ≈ûifre Sƒ±fƒ±rlama (Reset Password)**

#### **Ne Yapmalƒ±sƒ±nƒ±z:**
- Email link'inden gelen `email` ve `token` parametrelerini alƒ±n
- Email alanƒ±nƒ± disabled yapƒ±n (kullanƒ±cƒ± deƒüi≈ütiremesin)
- Token'ƒ± gizli tutun (kullanƒ±cƒ± g√∂rmesin)
- Kullanƒ±cƒ±dan `newPassword` ve `confirmPassword` isteyin
- ≈ûifre validasyonu yapƒ±n (en az 8 karakter, b√ºy√ºk/k√º√ß√ºk harf, rakam, √∂zel karakter)
- `POST /api/v1/auth/resetPassword` endpoint'ini √ßaƒüƒ±rƒ±n
- Ba≈üarƒ±lƒ± olursa login sayfasƒ±na y√∂nlendirin

#### **Request Format:**
```json
{
  "email": "john@example.com",
  "token": "reset_token_from_email",
  "newPassword": "NewSecurePass123!"
}
```

#### **Response Format:**
```json
{
  "success": true,
  "message": "≈ûifre ba≈üarƒ±yla g√ºncellendi"
}
```

#### **Hata Durumlarƒ±:**
- **400 Bad Request**: Token s√ºresi dolmu≈ü, ≈üifre √ßok zayƒ±f
- **404 Not Found**: Email bulunamadƒ±
- **422 Validation Error**: ≈ûifre validasyon hatalarƒ±

---

### **7. Uygulama ƒ∞√ßi ≈ûifre Deƒüi≈ütirme (Change Password)**

#### **Ne Yapmalƒ±sƒ±nƒ±z:**
- Kullanƒ±cƒ±nƒ±n giri≈ü yapmƒ±≈ü olmasƒ± gerekir
- Authorization header'ƒ±nda access token g√∂nderin
- Kullanƒ±cƒ±dan `currentPassword` ve `newPassword` isteyin
- ≈ûifre validasyonu yapƒ±n (en az 8 karakter, b√ºy√ºk/k√º√ß√ºk harf, rakam, √∂zel karakter)
- `POST /api/v1/auth/changePassword` endpoint'ini √ßaƒüƒ±rƒ±n
- Ba≈üarƒ±lƒ± olursa "≈ûifreniz ba≈üarƒ±yla g√ºncellendi" mesajƒ± g√∂sterin

#### **Request Format:**
```json
{
  "currentPassword": "CurrentPass123!",
  "newPassword": "NewSecurePass456!"
}
```

#### **Response Format:**
```json
{
  "success": true,
  "message": "≈ûifreniz ba≈üarƒ±yla g√ºncellendi"
}
```

#### **Hata Durumlarƒ±:**
- **401 Unauthorized**: Ge√ßersiz access token
- **400 Bad Request**: Mevcut ≈üifre yanlƒ±≈ü, yeni ≈üifre √ßok zayƒ±f
- **422 Validation Error**: ≈ûifre validasyon hatalarƒ±

---

## ‚öõÔ∏è React Entegrasyonu

### 1. Auth Context ve Hook'lar

```javascript
// contexts/AuthContext.js
import React, { createContext, useContext, useReducer, useEffect } from 'react';

const AuthContext = createContext();

// Auth state reducer
const authReducer = (state, action) => {
  switch (action.type) {
    case 'LOGIN_SUCCESS':
      return {
        ...state,
        isAuthenticated: true,
        user: action.payload.user,
        accessToken: action.payload.accessToken,
        refreshToken: action.payload.refreshToken,
        loading: false
      };
    case 'LOGOUT':
      return {
        ...state,
        isAuthenticated: false,
        user: null,
        accessToken: null,
        refreshToken: null,
        loading: false
      };
    case 'SET_LOADING':
      return { ...state, loading: action.payload };
    default:
      return state;
  }
};

// Auth Provider Component
export const AuthProvider = ({ children }) => {
  const [state, dispatch] = useReducer(authReducer, {
    isAuthenticated: false,
    user: null,
    accessToken: localStorage.getItem('accessToken'),
    refreshToken: localStorage.getItem('refreshToken'),
    loading: true
  });

  const authService = new TE4ITAuthService();

  // Sayfa y√ºklendiƒüinde token kontrol√º
  useEffect(() => {
    const initAuth = async () => {
      if (state.accessToken && state.refreshToken) {
        try {
          // Token ge√ßerliliƒüini kontrol et
          const response = await authService.apiCall('/api/v1/auth/me');
          if (response.ok) {
            const userData = await response.json();
            dispatch({
              type: 'LOGIN_SUCCESS',
              payload: {
                user: userData,
                accessToken: state.accessToken,
                refreshToken: state.refreshToken
              }
            });
          } else {
            // Token ge√ßersiz, temizle
            authService.clearTokens();
            dispatch({ type: 'LOGOUT' });
          }
        } catch (error) {
          console.error('Auth initialization failed:', error);
          authService.clearTokens();
          dispatch({ type: 'LOGOUT' });
        }
      } else {
        dispatch({ type: 'SET_LOADING', payload: false });
      }
    };

    initAuth();
  }, []);

  const login = async (email, password) => {
    try {
      dispatch({ type: 'SET_LOADING', payload: true });
      
      const response = await fetch(`${authService.baseUrl}/api/v1/auth/login`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      });

      if (!response.ok) {
        throw new Error('Login failed');
      }

      const data = await response.json();
      authService.saveTokens(data.accessToken, data.refreshToken);
      
      dispatch({
        type: 'LOGIN_SUCCESS',
        payload: {
          user: { email: data.email, userId: data.userId },
          accessToken: data.accessToken,
          refreshToken: data.refreshToken
        }
      });

      return { success: true, data };
    } catch (error) {
      dispatch({ type: 'SET_LOADING', payload: false });
      return { success: false, error: error.message };
    }
  };

  const register = async (userName, email, password) => {
    try {
      dispatch({ type: 'SET_LOADING', payload: true });
      
      const response = await fetch(`${authService.baseUrl}/api/v1/auth/register`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ userName, email, password })
      });

      if (!response.ok) {
        throw new Error('Registration failed');
      }

      const data = await response.json();
      authService.saveTokens(data.accessToken, data.refreshToken);
      
      dispatch({
        type: 'LOGIN_SUCCESS',
        payload: {
          user: { email: data.email, userId: data.userId, userName: data.userName },
          accessToken: data.accessToken,
          refreshToken: data.refreshToken
        }
      });

      return { success: true, data };
    } catch (error) {
      dispatch({ type: 'SET_LOADING', payload: false });
      return { success: false, error: error.message };
    }
  };

  const logout = async () => {
    try {
      if (state.refreshToken) {
        await authService.apiCall('/api/v1/auth/revokeRefreshToken', {
          method: 'POST',
          body: JSON.stringify({ refreshToken: state.refreshToken })
        });
      }
    } catch (error) {
      console.error('Logout error:', error);
    } finally {
      authService.clearTokens();
      dispatch({ type: 'LOGOUT' });
    }
  };

  const forgotPassword = async (email) => {
    try {
      const response = await fetch(`${authService.baseUrl}/api/v1/auth/forgotPassword`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email })
      });

      return { success: response.ok };
    } catch (error) {
      return { success: false, error: error.message };
    }
  };

  const resetPassword = async (email, token, newPassword) => {
    try {
      const response = await fetch(`${authService.baseUrl}/api/v1/auth/resetPassword`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, token, newPassword })
      });

      const data = await response.json();
      return { success: response.ok, data };
    } catch (error) {
      return { success: false, error: error.message };
    }
  };

  const changePassword = async (currentPassword, newPassword) => {
    try {
      const response = await authService.apiCall('/api/v1/auth/changePassword', {
        method: 'POST',
        body: JSON.stringify({ currentPassword, newPassword })
      });

      const data = await response.json();
      return { success: response.ok, data };
    } catch (error) {
      return { success: false, error: error.message };
    }
  };

  const value = {
    ...state,
    login,
    register,
    logout,
    forgotPassword,
    resetPassword,
    changePassword,
    authService
  };

  return (
    <AuthContext.Provider value={value}>
      {children}
    </AuthContext.Provider>
  );
};

// Custom Hook
export const useAuth = () => {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
};
```

### 2. Login Component

```javascript
// components/LoginForm.jsx
import React, { useState } from 'react';
import { useAuth } from '../contexts/AuthContext';
import { useNavigate } from 'react-router-dom';

const LoginForm = () => {
  const [formData, setFormData] = useState({
    email: '',
    password: ''
  });
  const [error, setError] = useState('');
  
  const { login, loading } = useAuth();
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');

    const result = await login(formData.email, formData.password);
    
    if (result.success) {
      navigate('/dashboard');
    } else {
      setError(result.error);
    }
  };

  const handleChange = (e) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value
    });
  };

  return (
    <form onSubmit={handleSubmit} className="login-form">
      <h2>Giri≈ü Yap</h2>
      
      {error && <div className="error-message">{error}</div>}
      
      <div className="form-group">
        <label htmlFor="email">Email:</label>
        <input
          type="email"
          id="email"
          name="email"
          value={formData.email}
          onChange={handleChange}
          required
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="password">≈ûifre:</label>
        <input
          type="password"
          id="password"
          name="password"
          value={formData.password}
          onChange={handleChange}
          required
        />
      </div>
      
      <button type="submit" disabled={loading}>
        {loading ? 'Giri≈ü yapƒ±lƒ±yor...' : 'Giri≈ü Yap'}
      </button>
      
      <div className="form-links">
        <a href="/forgot-password">≈ûifremi Unuttum</a>
        <a href="/register">Kayƒ±t Ol</a>
      </div>
    </form>
  );
};

export default LoginForm;
```

### 3. Password Reset Component

```javascript
// components/PasswordResetForm.jsx
import React, { useState, useEffect } from 'react';
import { useAuth } from '../contexts/AuthContext';
import { useSearchParams, useNavigate } from 'react-router-dom';

const PasswordResetForm = () => {
  const [searchParams] = useSearchParams();
  const navigate = useNavigate();
  const { resetPassword } = useAuth();
  
  const [formData, setFormData] = useState({
    email: searchParams.get('email') || '',
    token: searchParams.get('token') || '',
    newPassword: '',
    confirmPassword: ''
  });
  
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);
  const [loading, setLoading] = useState(false);

  // URL'den token ve email geldi mi kontrol et
  const hasToken = searchParams.get('token') && searchParams.get('email');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');

    if (formData.newPassword !== formData.confirmPassword) {
      setError('≈ûifreler e≈üle≈ümiyor');
      return;
    }

    if (formData.newPassword.length < 8) {
      setError('≈ûifre en az 8 karakter olmalƒ±');
      return;
    }

    setLoading(true);

    const result = await resetPassword(
      formData.email,
      formData.token,
      formData.newPassword
    );

    if (result.success) {
      setSuccess(true);
      setTimeout(() => {
        navigate('/login');
      }, 3000);
    } else {
      setError(result.error || '≈ûifre sƒ±fƒ±rlama ba≈üarƒ±sƒ±z');
    }

    setLoading(false);
  };

  const handleChange = (e) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value
    });
  };

  if (success) {
    return (
      <div className="success-message">
        <h2>‚úÖ ≈ûifre Ba≈üarƒ±yla G√ºncellendi!</h2>
        <p>≈ûifreniz ba≈üarƒ±yla g√ºncellendi. 3 saniye sonra giri≈ü sayfasƒ±na y√∂nlendirileceksiniz.</p>
      </div>
    );
  }

  if (!hasToken) {
    return (
      <div className="error-message">
        <h2>‚ùå Ge√ßersiz Link</h2>
        <p>Bu ≈üifre sƒ±fƒ±rlama linki ge√ßersiz veya s√ºresi dolmu≈ü.</p>
        <a href="/forgot-password">Yeni ≈üifre sƒ±fƒ±rlama isteƒüi g√∂nder</a>
      </div>
    );
  }

  return (
    <form onSubmit={handleSubmit} className="password-reset-form">
      <h2>≈ûifre Sƒ±fƒ±rla</h2>
      
      {error && <div className="error-message">{error}</div>}
      
      <div className="form-group">
        <label htmlFor="email">Email:</label>
        <input
          type="email"
          id="email"
          name="email"
          value={formData.email}
          onChange={handleChange}
          disabled
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="newPassword">Yeni ≈ûifre:</label>
        <input
          type="password"
          id="newPassword"
          name="newPassword"
          value={formData.newPassword}
          onChange={handleChange}
          required
          minLength="8"
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="confirmPassword">≈ûifre Tekrar:</label>
        <input
          type="password"
          id="confirmPassword"
          name="confirmPassword"
          value={formData.confirmPassword}
          onChange={handleChange}
          required
          minLength="8"
        />
      </div>
      
      <button type="submit" disabled={loading}>
        {loading ? 'G√ºncelleniyor...' : '≈ûifreyi G√ºncelle'}
      </button>
    </form>
  );
};

export default PasswordResetForm;
```

### 4. Change Password Component

```javascript
// components/ChangePasswordForm.jsx
import React, { useState } from 'react';
import { useAuth } from '../contexts/AuthContext';

const ChangePasswordForm = ({ onSuccess }) => {
  const [formData, setFormData] = useState({
    currentPassword: '',
    newPassword: '',
    confirmPassword: ''
  });
  
  const [error, setError] = useState('');
  const [success, setSuccess] = useState('');
  const [loading, setLoading] = useState(false);
  
  const { changePassword } = useAuth();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    setSuccess('');

    if (formData.newPassword !== formData.confirmPassword) {
      setError('Yeni ≈üifreler e≈üle≈ümiyor');
      return;
    }

    if (formData.newPassword.length < 8) {
      setError('Yeni ≈üifre en az 8 karakter olmalƒ±');
      return;
    }

    if (formData.currentPassword === formData.newPassword) {
      setError('Yeni ≈üifre mevcut ≈üifre ile aynƒ± olamaz');
      return;
    }

    setLoading(true);

    const result = await changePassword(
      formData.currentPassword,
      formData.newPassword
    );

    if (result.success) {
      setSuccess('≈ûifreniz ba≈üarƒ±yla g√ºncellendi');
      setFormData({
        currentPassword: '',
        newPassword: '',
        confirmPassword: ''
      });
      
      if (onSuccess) {
        onSuccess();
      }
    } else {
      setError(result.error || '≈ûifre deƒüi≈ütirme ba≈üarƒ±sƒ±z');
    }

    setLoading(false);
  };

  const handleChange = (e) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value
    });
  };

  return (
    <form onSubmit={handleSubmit} className="change-password-form">
      <h3>≈ûifre Deƒüi≈ütir</h3>
      
      {error && <div className="error-message">{error}</div>}
      {success && <div className="success-message">{success}</div>}
      
      <div className="form-group">
        <label htmlFor="currentPassword">Mevcut ≈ûifre:</label>
        <input
          type="password"
          id="currentPassword"
          name="currentPassword"
          value={formData.currentPassword}
          onChange={handleChange}
          required
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="newPassword">Yeni ≈ûifre:</label>
        <input
          type="password"
          id="newPassword"
          name="newPassword"
          value={formData.newPassword}
          onChange={handleChange}
          required
          minLength="8"
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="confirmPassword">Yeni ≈ûifre Tekrar:</label>
        <input
          type="password"
          id="confirmPassword"
          name="confirmPassword"
          value={formData.confirmPassword}
          onChange={handleChange}
          required
          minLength="8"
        />
      </div>
      
      <button type="submit" disabled={loading}>
        {loading ? 'G√ºncelleniyor...' : '≈ûifreyi G√ºncelle'}
      </button>
    </form>
  );
};

export default ChangePasswordForm;
```

---

## üîó Email Link Handling

### **Email Link Formatƒ±**
Backend'den gelen email'deki link formatƒ±:
```
https://te4it-frontend.azurestaticapps.net/reset-password?email=user@example.com&token=abc123xyz
```

### **Ne Yapmalƒ±sƒ±nƒ±z:**

#### **1. React Router Setup**
- `/reset-password` route'unu tanƒ±mlayƒ±n
- Bu route'a gelen kullanƒ±cƒ±larƒ± `PasswordResetForm` component'ine y√∂nlendirin
- URL parametrelerini otomatik olarak yakalayƒ±n

#### **2. URL Parametrelerini Alma**
- `useSearchParams` hook'u ile URL parametrelerini alƒ±n
- `searchParams.get('email')` ile email'i alƒ±n
- `searchParams.get('token')` ile token'ƒ± alƒ±n
- Bu parametreleri form state'ine otomatik doldurun

#### **3. Form Alanlarƒ±nƒ± Ayarlama**
- Email alanƒ±nƒ± `disabled` yapƒ±n (kullanƒ±cƒ± deƒüi≈ütiremesin)
- Token'ƒ± gizli tutun (kullanƒ±cƒ± g√∂rmesin)
- Sadece yeni ≈üifre alanlarƒ±nƒ± aktif bƒ±rakƒ±n

#### **4. Hata Durumlarƒ±**
- Token yoksa "Ge√ßersiz link" mesajƒ± g√∂sterin
- Email yoksa "Ge√ßersiz link" mesajƒ± g√∂sterin
- Token s√ºresi dolmu≈üsa "Link'in s√ºresi dolmu≈ü" mesajƒ± g√∂sterin

### **√ñrnek Implementasyon:**

```javascript
// components/PasswordResetForm.jsx
import React, { useState, useEffect } from 'react';
import { useSearchParams, useNavigate } from 'react-router-dom';
import { useAuth } from '../contexts/AuthContext';

const PasswordResetForm = () => {
  const [searchParams] = useSearchParams();
  const navigate = useNavigate();
  const { resetPassword } = useAuth();
  
  const [formData, setFormData] = useState({
    email: searchParams.get('email') || '',
    token: searchParams.get('token') || '',
    newPassword: '',
    confirmPassword: ''
  });
  
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);
  const [loading, setLoading] = useState(false);

  // URL'den token ve email geldi mi kontrol et
  const hasToken = searchParams.get('token') && searchParams.get('email');

  useEffect(() => {
    if (!hasToken) {
      setError('Ge√ßersiz ≈üifre sƒ±fƒ±rlama linki');
    }
  }, [hasToken]);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');

    if (formData.newPassword !== formData.confirmPassword) {
      setError('≈ûifreler e≈üle≈ümiyor');
      return;
    }

    if (formData.newPassword.length < 8) {
      setError('≈ûifre en az 8 karakter olmalƒ±');
      return;
    }

    setLoading(true);

    const result = await resetPassword(
      formData.email,
      formData.token,
      formData.newPassword
    );

    if (result.success) {
      setSuccess(true);
      setTimeout(() => {
        navigate('/login');
      }, 3000);
    } else {
      setError(result.error || '≈ûifre sƒ±fƒ±rlama ba≈üarƒ±sƒ±z');
    }

    setLoading(false);
  };

  if (success) {
    return (
      <div className="success-message">
        <h2>‚úÖ ≈ûifre Ba≈üarƒ±yla G√ºncellendi!</h2>
        <p>≈ûifreniz ba≈üarƒ±yla g√ºncellendi. 3 saniye sonra giri≈ü sayfasƒ±na y√∂nlendirileceksiniz.</p>
      </div>
    );
  }

  if (!hasToken) {
    return (
      <div className="error-message">
        <h2>‚ùå Ge√ßersiz Link</h2>
        <p>Bu ≈üifre sƒ±fƒ±rlama linki ge√ßersiz veya s√ºresi dolmu≈ü.</p>
        <a href="/forgot-password">Yeni ≈üifre sƒ±fƒ±rlama isteƒüi g√∂nder</a>
      </div>
    );
  }

  return (
    <form onSubmit={handleSubmit} className="password-reset-form">
      <h2>≈ûifre Sƒ±fƒ±rla</h2>
      
      {error && <div className="error-message">{error}</div>}
      
      <div className="form-group">
        <label htmlFor="email">Email:</label>
        <input
          type="email"
          id="email"
          name="email"
          value={formData.email}
          disabled
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="newPassword">Yeni ≈ûifre:</label>
        <input
          type="password"
          id="newPassword"
          name="newPassword"
          value={formData.newPassword}
          onChange={(e) => setFormData({...formData, newPassword: e.target.value})}
          required
          minLength="8"
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="confirmPassword">≈ûifre Tekrar:</label>
        <input
          type="password"
          id="confirmPassword"
          name="confirmPassword"
          value={formData.confirmPassword}
          onChange={(e) => setFormData({...formData, confirmPassword: e.target.value})}
          required
          minLength="8"
        />
      </div>
      
      <button type="submit" disabled={loading}>
        {loading ? 'G√ºncelleniyor...' : '≈ûifreyi G√ºncelle'}
      </button>
    </form>
  );
};

export default PasswordResetForm;
```

---

## üõ°Ô∏è G√ºvenlik En ƒ∞yi Uygulamalarƒ±

### 1. Token G√ºvenliƒüi

```javascript
// utils/tokenSecurity.js
export const secureTokenStorage = {
  // Token'larƒ± ≈üifreleyerek sakla
  saveTokens: (accessToken, refreshToken) => {
    try {
      // Basit encoding (production'da daha g√º√ßl√º ≈üifreleme kullan)
      const encodedAccess = btoa(accessToken);
      const encodedRefresh = btoa(refreshToken);
      
      localStorage.setItem('accessToken', encodedAccess);
      localStorage.setItem('refreshToken', encodedRefresh);
    } catch (error) {
      console.error('Token kaydetme hatasƒ±:', error);
    }
  },

  // Token'larƒ± √ß√∂z
  getTokens: () => {
    try {
      const encodedAccess = localStorage.getItem('accessToken');
      const encodedRefresh = localStorage.getItem('refreshToken');
      
      if (encodedAccess && encodedRefresh) {
        return {
          accessToken: atob(encodedAccess),
          refreshToken: atob(encodedRefresh)
        };
      }
    } catch (error) {
      console.error('Token okuma hatasƒ±:', error);
    }
    
    return { accessToken: null, refreshToken: null };
  },

  // Token'larƒ± temizle
  clearTokens: () => {
    localStorage.removeItem('accessToken');
    localStorage.removeItem('refreshToken');
  }
};
```

### 2. Input Validation

```javascript
// utils/validation.js
export const validateEmail = (email) => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
};

export const validatePassword = (password) => {
  const minLength = password.length >= 8;
  const hasUpperCase = /[A-Z]/.test(password);
  const hasLowerCase = /[a-z]/.test(password);
  const hasNumbers = /\d/.test(password);
  const hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);
  
  return {
    isValid: minLength && hasUpperCase && hasLowerCase && hasNumbers && hasSpecialChar,
    errors: {
      minLength: !minLength ? 'En az 8 karakter olmalƒ±' : null,
      hasUpperCase: !hasUpperCase ? 'En az 1 b√ºy√ºk harf olmalƒ±' : null,
      hasLowerCase: !hasLowerCase ? 'En az 1 k√º√ß√ºk harf olmalƒ±' : null,
      hasNumbers: !hasNumbers ? 'En az 1 rakam olmalƒ±' : null,
      hasSpecialChar: !hasSpecialChar ? 'En az 1 √∂zel karakter olmalƒ±' : null
    }
  };
};
```

---

## üß™ Test Senaryolarƒ±

### 1. Unit Test √ñrneƒüi

```javascript
// __tests__/AuthService.test.js
import { TE4ITAuthService } from '../services/AuthService';

describe('TE4ITAuthService', () => {
  let authService;

  beforeEach(() => {
    authService = new TE4ITAuthService('https://localhost:5001');
    localStorage.clear();
  });

  test('should save tokens to localStorage', () => {
    const accessToken = 'test-access-token';
    const refreshToken = 'test-refresh-token';
    
    authService.saveTokens(accessToken, refreshToken);
    
    expect(localStorage.getItem('accessToken')).toBe(accessToken);
    expect(localStorage.getItem('refreshToken')).toBe(refreshToken);
  });

  test('should clear tokens from localStorage', () => {
    authService.saveTokens('access', 'refresh');
    authService.clearTokens();
    
    expect(localStorage.getItem('accessToken')).toBeNull();
    expect(localStorage.getItem('refreshToken')).toBeNull();
  });
});
```

### 2. Integration Test √ñrneƒüi

```javascript
// __tests__/LoginFlow.test.js
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { BrowserRouter } from 'react-router-dom';
import { AuthProvider } from '../contexts/AuthContext';
import LoginForm from '../components/LoginForm';

const renderWithAuth = (component) => {
  return render(
    <BrowserRouter>
      <AuthProvider>
        {component}
      </AuthProvider>
    </BrowserRouter>
  );
};

test('should login successfully with valid credentials', async () => {
  // Mock fetch
  global.fetch = jest.fn(() =>
    Promise.resolve({
      ok: true,
      json: () => Promise.resolve({
        userId: '123',
        email: 'test@example.com',
        accessToken: 'mock-access-token',
        refreshToken: 'mock-refresh-token'
      })
    })
  );

  renderWithAuth(<LoginForm />);

  fireEvent.change(screen.getByLabelText(/email/i), {
    target: { value: 'test@example.com' }
  });
  
  fireEvent.change(screen.getByLabelText(/≈üifre/i), {
    target: { value: 'Password123!' }
  });
  
  fireEvent.click(screen.getByRole('button', { name: /giri≈ü yap/i }));

  await waitFor(() => {
    expect(fetch).toHaveBeenCalledWith(
      expect.stringContaining('/api/v1/auth/login'),
      expect.objectContaining({
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          email: 'test@example.com',
          password: 'Password123!'
        })
      })
    );
  });
});
```

---

## üìû Destek ve Kaynaklar

### Hƒ±zlƒ± Ba≈üvuru

- **Production API**: `https://te4it-api.azurewebsites.net`
- **Development API**: `https://localhost:5001`
- **Swagger UI**: `https://te4it-api.azurewebsites.net/swagger`
- **GitHub**: https://github.com/burhanarslanbas/TE4IT

### Sorun Giderme

1. **CORS Hatasƒ±**: API base URL'ini kontrol edin
2. **Token Hatasƒ±**: Token'larƒ±n doƒüru kaydedildiƒüini kontrol edin
3. **Network Hatasƒ±**: Internet baƒülantƒ±nƒ±zƒ± kontrol edin
4. **Validation Hatasƒ±**: Form verilerinin doƒüru formatƒ±nƒ± kontrol edin

### ƒ∞leti≈üim

- **Email**: infoarslanbas@gmail.com
- **GitHub Issues**: https://github.com/burhanarslanbas/TE4IT/issues

---

*Bu dok√ºmantasyon TE4IT Frontend Entegrasyon Rehberi v1.0 i√ßin hazƒ±rlanmƒ±≈ütƒ±r. Son g√ºncelleme: Ocak 2025*
